function [stcr,dofin,dofout,dofcr] = sterdofinoutcr(x,y,lag)%Function [stcr,dofin,dofout,dofcr] = sterdofinoutcr(x,y,lag) %  stcr is large-lag standard error of CCs.%  Compute the large-lag standard error of crosscorrelations,%  and the # of degrees of freedom for auto and crosscorrelations separately.%  x & y can be demeaned (or not, unlike ster2) column vectors.%  Lag is an optional override for the %  maximum number of lags. Default is the series length-1 or 100,%  whichever is less. The LLSE is computed (Davis, 1976) as  %%%	   tindsccr=Acx'*Acy	%Acx and Acy are both normalized%	   dofcr=len/tindsccr;%      stcr = sqrt(1/dofcr), where%%      Acx, Acy = autocorrelation functions of X & Y%  See:  Davis, R., J.Phys.Oceanogr., 6, 249-266, 1976len = length(x)-1;if nargin < 3; lag = min(100,len); endcx = Xcbg(lag,x);cy = Xcbg(lag,y);tindscin = cx(:,2)'*cx(:,2);dofin=len/tindscin;tindscout = cy(:,2)'*cy(:,2);dofout=len/tindscout;tindsccr = cx(:,2)'*cy(:,2);dofcr=len/tindsccr;stcr=sqrt(1/dofcr);